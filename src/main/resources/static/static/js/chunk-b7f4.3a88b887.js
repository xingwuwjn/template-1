(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-b7f4"],{BJOg:function(e,t,s){},eR8p:function(e,t,s){"use strict";s.r(t);var i=s("s8mb"),n={data:function(){return{keywords:"",fullloading:!1,hrs:[],cardLoading:[],eploading:[],allRoles:[],moreBtnState:!1,selRoles:[],selRolesBak:[]}},mounted:function(){this.initCards(),this.loadAllRoles()},methods:{searchClick:function(){this.initCards(),this.loadAllRoles()},updateHrRoles:function(e,t){this.moreBtnState=!1;var s=this;if(this.selRolesBak.length===this.selRoles.length){for(var n=0;n<this.selRoles.length;n++)for(var a=0;a<this.selRolesBak.length;a++)if(this.selRoles[n]===this.selRolesBak[a]){this.selRolesBak.splice(a,1);break}if(0===this.selRolesBak.length)return}this.eploading.splice(t,1,!0),Object(i.k)({hrId:e,rids:this.selRoles}).then(function(i){(s.eploading.splice(t,1,!1),i&&200===i.status)&&("success"===i.data.status&&s.refreshHr(e,t))})},refreshHr:function(e,t){var s=this;s.cardLoading.splice(t,1,!0),Object(i.g)(e).then(function(e){s.cardLoading.splice(t,1,!1),s.hrs.splice(t,1,e.data)})},loadSelRoles:function(e,t){var s=this;this.moreBtnState=!0,this.selRoles=[],this.selRolesBak=[],e.forEach(function(e){s.selRoles.push(e.id),s.selRolesBak.push(e.id)})},loadAllRoles:function(){var e=this;i.e.then(function(t){e.fullloading=!1,t&&200===t.status&&(e.allRoles=t.data)})},switchChange:function(e,t,s){var n=this;n.cardLoading.splice(s,1,!0),Object(i.j)({enabled:e,id:t}).then(function(e){(n.cardLoading.splice(s,1,!1),e&&200===e.status)?"error"===e.data.status&&n.refreshHr(t,s):n.refreshHr(t,s)})},initCards:function(){this.fullloading=!0;var e,t=this;e=""===this.keywords?"all":this.keywords,Object(i.f)(e).then(function(e){if(e&&200===e.status){t.hrs=e.data;var s=e.data.length;t.cardLoading=Array.apply(null,Array(s)).map(function(e,t){return!1}),t.eploading=Array.apply(null,Array(s)).map(function(e,t){return!1})}})},deleteHr:function(e){var t=this;this.fullloading=!0,Object(i.b)(e).then(function(e){(t.fullloading=!1,e&&200===e.status)&&("success"===e.data.status&&(t.initCards(),t.loadAllRoles()))})}}},a=(s("omly"),s("KHd+")),l=Object(a.a)(n,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.fullloading,expression:"fullloading"}],staticStyle:{"margin-top":"10px"}},[s("div",{staticStyle:{"margin-bottom":"10px",display:"flex","justify-content":"center","align-items":"center"}},[s("el-input",{staticStyle:{width:"400px","margin-right":"10px"},attrs:{model:e.keywords,placeholder:"默认展示部分用户，可以通过用户名搜索更多用户...","prefix-icon":"el-icon-search",size:"small"}}),e._v(" "),s("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchClick}},[e._v("搜索")])],1),e._v(" "),s("div",{staticStyle:{display:"flex","justify-content":"space-around","flex-wrap":"wrap","text-align":"left"}},e._l(e.hrs,function(t,i){return s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.cardLoading[i],expression:"cardLoading[index]"}],key:t.id,staticStyle:{width:"350px","margin-bottom":"20px"}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[e._v("{item.name}")]),e._v(" "),s("el-button",{staticStyle:{color:"#f6061b",margin:"0px",float:"right",padding:"3px 0",width:"15px",height:"15px"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(s){e.deleteHr(t.id)}}})],1),e._v(" "),s("div",[s("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center"}},[s("img",{staticStyle:{width:"70px",height:"70px","border-radius":"70px"},attrs:{src:t.userface,alt:"item.name"}})]),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("div",[s("span",{staticClass:"user-info"},[e._v("用户名:{item.name}")])]),e._v(" "),s("div",[s("span",{staticClass:"user-info"},[e._v("手机号码:{item.phone}")])]),e._v(" "),s("div",[s("span",{staticClass:"user-info"},[e._v("电话号码:{item.telephone}")])]),e._v(" "),s("div",[s("span",{staticClass:"user-info"},[e._v("地址:{item.address}")])]),e._v(" "),s("div",{staticClass:"user-info",staticStyle:{display:"flex","align-items":"center","margin-bottom":"3px"}},[e._v("\n            用户状态:\n            "),s("el-switch",{key:t.id,staticStyle:{display:"inline","margin-left":"5px"},attrs:{"active-color":"#13ce66","inactive-color":"#aaaaaa","active-text":"启用","inactive-text":"禁用"},on:{change:function(s){e.switchChange(t.enabled,t.id,i)}},model:{value:t.enabled,callback:function(s){e.$set(t,"enabled",s)},expression:"item.enabled"}})],1),e._v(" "),s("div",{staticClass:"user-info"},[e._v("\n            用户角色:\n            "),e._l(t.roles,function(t){return s("el-tag",{key:t.id,staticStyle:{"margin-right":"5px"},attrs:{"disable-transitions":!1,type:"success",size:"mini"}},[e._v("{role.nameZh}\n            ")])}),e._v(" "),s("el-popover",{directives:[{name:"loading",rawName:"v-loading",value:e.eploading[i],expression:"eploading[index]"}],key:t.id,attrs:{trigger:"click",placement:"right",title:"角色列表",width:"200"},on:{hide:function(s){e.updateHrRoles(t.id,i)}}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择角色"},model:{value:e.selRoles,callback:function(t){e.selRoles=t},expression:"selRoles"}},e._l(e.allRoles,function(e){return s("el-option",{key:e.id,attrs:{label:e.nameZh,value:e.id}})})),e._v(" "),s("el-button",{staticStyle:{color:"#09c0f6","padding-top":"0px"},attrs:{slot:"reference",disabled:e.moreBtnState,type:"text",icon:"el-icon-more"},on:{click:function(s){e.loadSelRoles(t.roles,i)}},slot:"reference"})],1)],2),e._v(" "),s("div",[s("span",{staticClass:"user-info"},[e._v("备注:{item.remark}")])])])])])}))])},[],!1,null,null,null);l.options.__file="SysUser.vue";t.default=l.exports},omly:function(e,t,s){"use strict";var i=s("BJOg");s.n(i).a},s8mb:function(e,t,s){"use strict";s.d(t,"f",function(){return n}),s.d(t,"g",function(){return a}),s.d(t,"b",function(){return l}),s.d(t,"j",function(){return r}),s.d(t,"k",function(){return o}),s.d(t,"e",function(){return c}),s.d(t,"a",function(){return d}),s.d(t,"c",function(){return u}),s.d(t,"i",function(){return h}),s.d(t,"h",function(){return f}),s.d(t,"d",function(){return p});var i=s("t3Un");function n(e){return Object(i.a)({url:"/sys/users/"+e,method:"get",params:{searchWords:e}})}function a(e){return Object(i.a)({url:"/sys/users/"+e,method:"get"})}function l(e){return Object(i.a)({url:"/sys/users/"+e,method:"delete"})}function r(e,t){return Object(i.a)({url:"/sys/users/updateuser/",method:"put",data:{enabled:e,id:t}})}function o(e,t){return Object(i.a)({url:"/sys/users/updateuserrole/",method:"put",data:{hrId:e,rids:t}})}function c(){return Object(i.a)({url:"/sys/basic/roles",method:"get"})}function d(e,t){return Object(i.a)({url:"/sys/basic/addRole",method:"post",params:{role:e,roleZh:t}})}function u(e){return Object(i.a)({url:"/sys/basic/role/"+e,method:"delete"})}function h(e,t){return Object(i.a)({url:"/sys/basic/updateMenuRole",method:"post",data:{rid:e,mids:t}})}function f(e){return Object(i.a)({url:"/sys/basic/menuTree/"+e,method:"get"})}function p(){return Object(i.a)({url:"/basic/sysmenu/",method:"get"})}}}]);